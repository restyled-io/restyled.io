name:    restyled
version: "0.0.0"

# Dependencies shared in *all* targets
dependencies:
  - base

library:
  dependencies:
  - HTTP
  - aeson
  - bytestring
  - case-insensitive
  - classy-prelude
  - classy-prelude-yesod
  - conduit
  - containers
  - envparse
  - errors
  - fast-logger
  - file-embed
  - github
  - gitrev
  - hedis
  - hjsmin
  - http-client
  - http-conduit
  - http-types
  - load-env
  - monad-control
  - monad-logger
  - monadplus
  - network-uri
  - persistent
  - persistent-postgresql
  - persistent-template
  - process
  - shakespeare
  - template-haskell
  - text
  - time
  - unordered-containers
  - vector
  - wai
  - wai-extra
  - wai-logger
  - warp
  - yesod
  - yesod-auth
  - yesod-auth-oauth2
  - yesod-core
  - yesod-form
  - yesod-static
  source-dirs: src
  when:
  - condition: flag(dev)
    then:
      ghc-options:
      - -Wall
      - -fwarn-tabs
      - -O0
      cpp-options: -DDEVELOPMENT
    else:
      ghc-options:
      - -Wall
      - -fwarn-tabs
      - -O2

executables:
  restyled.io:
    main: main.hs
    source-dirs: app
    ghc-options:
    - -threaded
    - -rtsopts
    - -with-rtsopts=-N
    dependencies:
    - restyled

  restyled.io-backend:
    main: main.hs
    source-dirs: backend
    ghc-options:
    - -threaded
    - -rtsopts
    - -with-rtsopts=-N
    dependencies:
    - restyled

tests:
  test:
    main: Spec.hs
    source-dirs: test
    ghc-options: -Wall
    dependencies:
    - restyled
    - bytestring
    - classy-prelude
    - hedis
    - hspec
    - hspec-expectations-lifted
    - load-env
    - monad-logger
    - persistent
    - shakespeare
    - text
    - yesod-core
    - yesod-test

flags:
  library-only:
    description: Unused, but yesod-devel passes it.
    manual: false
    default: false
  dev:
    description: Turn on development settings, like auto-reload templates.
    manual: false
    default: false
